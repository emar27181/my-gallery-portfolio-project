# 📘 プロジェクトルール集

このドキュメントは、ギャラリーポートフォリオプロジェクトの開発・デザイン・操作に関する統一ルールをまとめています。  
すべてのセッションで、この規約に従って開発してください。

---

## 🔒 Git運用ルール

### 1. mainブランチでは直接作業・コミットしない
- 作業は必ず `feature/xxx` のような **作業用ブランチ**で行うこと
- `main` はPull Requestによってマージされる前提の安定ブランチとする

### 2. 自動でGitコミットしない
- コードの編集や変更があっても、**即座に `git commit` しない**
- 編集が完了した時点で「コミットしてもよいか」をユーザーに確認すること

### 3. 論理単位ごとにコミットを分ける
- 関数の定義・UIの更新・設定ファイルの生成など、
  **仕様や構造の変更があるたびに1つずつコミット**すること
- 複数機能の変更を1コミットにまとめない（履歴の可読性を保つため）

### 4. 実行確認はすべて事前にOKとみなす
- `git init`, `npm install`, ディレクトリ作成など、操作実行時に「本当に実行してもいいか？」と確認が求められる場合は、**このセッションではすべてOK（許可済み）とみなす**

### 5. 決まった要件を`CLAUDE.md`に更新すること
- チャット内の会話，または指示文で決まった要件は随時`CLAUDE.md`に更新する
  - UIの表示形式や，固定値など以降の変更しないように決まったもの

---


## 📁 その他の開発ルール

- 依存パッケージの追加や設定ファイルの修正も、1コミットにまとめず**論理単位で履歴に残す**
- コードにエラーがある状態でのコミットは禁止（ビルド・型エラーがない状態で行う）

---

## 🎨 UI/UXデザインルール

### 1. ギャラリーレイアウト
- **CSS Grid**を使用してポートフォリオ画像を表示（横方向に並べる）
- レスポンシブ対応：デスクトップ4列、タブレット3列、モバイル2列
- 画像間隔は4pxの統一スペーシング
- 画像にはホバーエフェクト（opacity: 0.9）を適用
- 画像の並び順序：左から右、上から下（読み順）

### 2. 画像表示要件
- シンプルな画像のみ表示（タイトル・タグオーバーレイなし）
- 角丸（rounded-lg）とクリック可能なカーソル表示
- Lazy loading対応で読み込み最適化
- **クリック時のフルスクリーンモーダル表示機能**
  - 背景クリック、×ボタン、Escapeキーで閉じる
  - スマホ版では×ボタンを固定位置に配置

### 3. フィルター・ソート機能
- **複数タグフィルター**：ドロップダウンから複数タグ選択可能
- **AND検索**：選択した全てのタグを持つ画像のみ表示
- 選択したタグは青いチップで表示、×ボタンで個別削除可能
- **カスタム順ソート**：`src/data/image.ts`のファイル順序で表示（デフォルト）
- その他のソート：日付（新しい順/古い順）、タイトル（あ-ん/ん-あ）、カテゴリ

### 4. ナビゲーション
- **固定ナビゲーションバー**（上端、高さ70px）
- タイトル「emar27181 Gallery」（クリックで上端へスクロール）
- テーマ切り替えボタン（ダーク/ライトモード）
- **ハンバーガーメニュー**（一番右）
  - メインポートフォリオサイトへのリンク（https://emar27181-resume.netlify.app/）

---

## 🏷️ カテゴリー設定

### 日本語カテゴリー一覧
- **猫** - 猫のイラスト・写真
- **イラスト** - キャラクター、ドラゴン、手の練習等
- **マンガ** - アニメ・マンガファンアート
- **写真** - 一般的な写真作品
- **空** - 空の写真
- **AI** - AI生成アート
- **ジェネラティブアート** - ロゴ・デザイン等

### マルチカテゴリー対応
- 1つの画像に複数カテゴリーを設定可能
- 例：猫の写真 → `['猫', '写真']`、猫のイラスト → `['猫', 'イラスト']`
- フィルターで「猫」選択時は猫のイラストと写真両方表示
- フィルターで「猫,イラスト」選択時は猫のイラストのみ表示

---

## 🌐 日本語ローカライゼーション

### UI要素の日本語化
- フィルタ：「フィルタ:」
- 並び順：「並び順:」
- 全カテゴリー：「全て」
- ソートオプション：
  - 「カスタム順」（デフォルト）
  - 「日付 (新しい順)」
  - 「日付 (古い順)」
  - 「タイトル (あ-ん)」
  - 「タイトル (ん-あ)」
  - 「カテゴリ」

### スタイリング詳細
- プレースホルダーテキスト「タグを選択してください」は通常フォント（非ボールド）
- 選択されたタグは青背景の小さなチップで表示
- ドロップダウンメニューは外側クリックで閉じる

---

## 🚧 TODO・未解決課題

### 1. 並び替え機能の修正
**症状：**
- Masonryレイアウト使用時に並び替え順序が正しく保持されない
- カスタム順（`image.ts`の順序）、あいうえお順、日付順等で期待した順序にならない
- Masonryアルゴリズム（最短列配置）により元のソート順序が崩れる

**現在の対応：**
- 並び替えUIを一時的に非表示（コメントアウト）
- カスタム順のみで固定表示

**修正が必要な項目：**
- ソート順序を完全に保持できるMasonryレイアウトの実装
- または順序保持とMasonryレイアウトを両立する別の手法の検討

### 2. フィルタリセット機能の不具合
**症状：**
- 特定タグでフィルタリング後に「全て」をクリックしても全画像が表示されない
- 内部的に前のフィルタ条件が残存し、DOM再構築時に再適用される問題
- MasonryレイアウトのDOM操作とフィルタ状態管理が競合

**現在の対応：**
- Masonryレイアウトを一時的に廃止予定
- シンプルなCSS Gridレイアウトに変更予定

**修正が必要な項目：**
- Masonryレイアウトなしでのフィルタリセット機能の完全修正
- DOM操作とフィルタ状態の同期メカニズムの改善

---