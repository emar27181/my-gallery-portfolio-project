# 📘 プロジェクトルール集

このドキュメントは、ギャラリーポートフォリオプロジェクトの開発・デザイン・操作に関する統一ルールをまとめています。  
すべてのセッションで、この規約に従って開発してください。

---

## 🔒 Git運用ルール

### 1. mainブランチでは直接作業・コミットしない
- 作業は必ず `feature/xxx` のような **作業用ブランチ**で行うこと
- `main` はPull Requestによってマージされる前提の安定ブランチとする

### 2. 自動でGitコミットしない（厳守）
- コードの編集や変更があっても、**絶対に勝手に `git commit` しない**
- 編集が完了した時点で「コミットしてもよいか」をユーザーに確認すること
- **ユーザーが明示的に「コミットして」と指示した場合のみコミットを実行する**
- この規則は例外なく厳守すること

### 3. 論理単位ごとにコミットを分ける
- 関数の定義・UIの更新・設定ファイルの生成など、
  **仕様や構造の変更があるたびに1つずつコミット**すること
- 複数機能の変更を1コミットにまとめない（履歴の可読性を保つため）

### 4. 実行確認はすべて事前にOKとみなす
- `git init`, `npm install`, ディレクトリ作成など、操作実行時に「本当に実行してもいいか？」と確認が求められる場合は、**このセッションではすべてOK（許可済み）とみなす**

### 5. 決まった要件を`CLAUDE.md`に更新すること
- チャット内の会話，または指示文で決まった要件は随時`CLAUDE.md`に更新する
  - UIの表示形式や，固定値など以降の変更しないように決まったもの

### 6. デプロイコマンド
- ユーザーが「デプロイして」と言った場合は `netlify deploy --prod` を実行する
- デプロイ完了後にURLを確認し、動作を報告する
- 本番URL: https://emar27181-gallery-portfolio.netlify.app

---


## 📁 その他の開発ルール

- 依存パッケージの追加や設定ファイルの修正も、1コミットにまとめず**論理単位で履歴に残す**
- コードにエラーがある状態でのコミットは禁止（ビルド・型エラーがない状態で行う）

---

## 🎨 UI/UXデザインルール

### 1. ギャラリーレイアウト
- **CSS Grid**を使用してポートフォリオ画像を表示（横方向に並べる）
- レスポンシブ対応：デスクトップ5列、タブレット3列、モバイル2列
- 画像間隔は4pxの統一スペーシング
- **全幅表示**：ギャラリーはウィンドウ幅いっぱいに表示、左右余白は画像間隔と同じ4px
- 画像にはホバーエフェクト（opacity: 0.9）を適用
- 画像の並び順序：左から右、上から下（読み順）
- **注意**：現在Masonryレイアウト実装により、並び替え機能との競合問題あり

### 2. 画像表示要件
- シンプルな画像のみ表示（タイトル・タグオーバーレイなし）
- 角丸（rounded-lg）とクリック可能なカーソル表示
- Lazy loading対応で読み込み最適化
- **クリック時のフルスクリーンモーダル表示機能**
  - 背景クリック、×ボタン、Escapeキーで閉じる
  - スマホ版では×ボタンを固定位置に配置

### 3. フィルター・ソート機能
- **複数タグフィルター**：ドロップダウンから複数タグ選択可能
- **AND検索**：選択した全てのタグを持つ画像のみ表示
- 選択したタグは青いチップで表示、×ボタンで個別削除可能
- **並び替え機能**：現在有効だが、Masonryレイアウトとの組み合わせで問題発生中
  - カスタム順：`src/data/image.ts`のファイル順序で表示（デフォルト）
  - その他のソート：日付（新しい順/古い順）、タイトル（あ-ん/ん-あ）、カテゴリ

### 4. ナビゲーション
- **固定ナビゲーションバー**（上端、高さ70px）
- タイトル「emar27181 Gallery」（クリックで上端へスクロール）
- テーマ切り替えボタン（ダーク/ライトモード）
- **ハンバーガーメニュー**（一番右）
  - メインポートフォリオサイトへのリンク（https://emar27181-resume.netlify.app/）

### 5. 動画対応機能
- **YouTube動画のサムネイル表示**：YouTubeサムネイルAPIを使用して動画のサムネイルを表示
- **動画プレイボタン**：動画アイテムにホバー時に再生ボタンを表示
- **動画モーダル**：動画クリック時にYouTube埋め込みプレイヤーをモーダルで表示
- **自動再生**：動画モーダル開始時に自動再生を開始（音声オン、ループ再生オフ）
- **レスポンシブ対応**：16:9アスペクト比を維持したレスポンシブ動画プレイヤー
- **動画表示サイズ**：デスクトップ/タブレット（3列以上）では3つ分、モバイル（2列）では2つ分のサイズ

---

## 🏷️ カテゴリー設定

### 日本語カテゴリー一覧
- **猫** - 猫のイラスト・写真
- **イラスト** - キャラクター、ドラゴン、手の練習等
- **マンガ** - アニメ・マンガファンアート
- **写真** - 一般的な写真作品
- **空** - 空の写真
- **AI** - AI生成アート
- **ジェネラティブアート** - ロゴ・デザイン等
- **動画** - YouTube動画コンテンツ

### マルチカテゴリー対応
- 1つの画像に複数カテゴリーを設定可能
- 例：猫の写真 → `['猫', '写真']`、猫のイラスト → `['猫', 'イラスト']`
- フィルターで「猫」選択時は猫のイラストと写真両方表示
- フィルターで「猫,イラスト」選択時は猫のイラストのみ表示

---

## 🌐 日本語ローカライゼーション

### UI要素の日本語化
- フィルタ：「フィルタ:」
- 並び替え：「並び替え:」
- 全カテゴリー：「全て」
- ソートオプション：
  - 「カスタム順」（デフォルト）
  - 「日付 (新しい順)」
  - 「日付 (古い順)」
  - 「タイトル (あ-ん)」
  - 「タイトル (ん-あ)」
  - 「カテゴリ」

### スタイリング詳細
- プレースホルダーテキスト「タグを選択」は通常フォント（非ボールド）
- 選択されたタグは青背景の小さなチップで表示
- ドロップダウンメニューは外側クリックで閉じる
- フィルタと並び替えUIは統一サイズ（幅140px、高さ2rem）で横並び配置
- コントロール要素間の余白は適切に調整（0.75rem）

---

## 🚧 TODO・未解決課題

### 1. 並び替え機能とレイアウトの問題
**症状：**
- 並び替え機能は現在有効になっているが、Masonryレイアウトとの組み合わせで問題発生
- Masonryアルゴリズム（最短列配置）により元のソート順序が正しく保持されない
- カスタム順（`image.ts`の順序）、あいうえお順、日付順等で期待した順序にならない

**現在の状態：**
- 並び替えUIは表示されており機能している
- しかしMasonryレイアウトのため順序が期待通りにならない

**修正が必要な項目：**
- Masonryレイアウトを無効化してシンプルなCSS Gridレイアウトに変更
- または、ソート順序を完全に保持できるMasonryレイアウトの新規実装

### 2. フィルタリセット機能の不具合
**症状：**
- 特定タグでフィルタリング後に「全て」をクリックしても全画像が表示されない
- 内部的に前のフィルタ条件が残存し、DOM再構築時に再適用される問題
- MasonryレイアウトのDOM操作とフィルタ状態管理が競合

**現在の状態：**
- フィルタリング機能は基本的に動作しているが、一部でリセット時の問題あり
- MasonryレイアウトのDOM操作がフィルタ状態管理と競合

**修正が必要な項目：**
- Masonryレイアウトを無効化することでフィルタリセット機能の問題解決
- DOM操作とフィルタ状態の同期メカニズムの改善

### 3. サインアニメーション機能の実装
**要件：**
- TODOとして、自分のサイン（emar27181のロゴ/サイン）が描かれていくアニメーションを実装
- ローディング表示として使用する想定
- SVGパスアニメーションまたはCanvas描画でサインが徐々に描かれる効果
- ローディング完了時にフェードアウトまたは適切な終了処理

**実装場所の候補：**
- 初回ページロード時のローディングスクリーン
- 画像フィルタリング・ソート処理中のローディング表示
- 動画読み込み中の待機画面

---